# Eagle API 調査ドキュメント

## 1. 概要

Eagle APIは、デジタルアセット管理ツール「Eagle」の機能を外部から操作するためのローカルAPIです。Eagleアプリケーション本体を起動すると、ローカルサーバーが `http://localhost:41595` で起動し、JSON形式でデータを提供します。

このAPIを利用することで、ユーザーは独自のプラグインやアドオンを開発し、Eagleの機能を拡張したり、他のツールと連携させたりすることが可能になります。

## 2. APIの仕様

### 2.1. 基本仕様

*   **サーバー**: Eagleアプリ起動時に自動で起動するローカルサーバー。
*   **URL**: `http://localhost:41595`
*   **データ形式**: JSON
*   **CORS**: Webページから直接利用する場合、`GM_xmlhttprequest` のようなラッパーが必要。
*   **利用要件**: Eagle 1.11 Build 21以降が必要。
*   **制限**: API呼び出し回数に制限はないが、パフォーマンスは実行しているデバイスに依存する。

### 2.2. 提供カテゴリと主要機能

APIは主に以下の4つのカテゴリに分類されます。

#### A. Application (アプリケーション)

アプリケーション自体の情報を取得・操作します。

*   **できること**:
    *   アプリケーション情報の取得（バージョン、ビルド番号など）。
    *   Eagleがサポートしているファイルタイプの取得。

#### B. Folder (フォルダ)

フォルダの作成、名前変更、情報取得など、フォルダに関する操作を行います。

*   **できること**:
    *   フォルダの一覧取得。
    *   指定したキーワードでのフォルダ検索。
    *   指定したIDのフォルダ情報取得。
    *   新規フォルダの作成（親フォルダの指定も可能）。
    *   フォルダ名の変更、説明の更新。
    *   フォルダのリネーム。

*   **できないこと (現行プロジェクトで実装済みの範囲外)**:
    *   フォルダの移動（親の変更は `update` で可能だが、直接的な `move` APIはない）。
    *   フォルダの削除（APIドキュメントには記載なし。ゴミ箱への移動など）。

#### C. Item (アイテム)

画像やブックマークなどのアイテムを追加、更新、削除します。

*   **できること**:
    *   URLやローカルパスからのアイテム追加。
    *   ブックマークの追加。
    *   アイテム情報の取得（メタデータ、タグ、注釈、評価など）。
    *   アイテムのメタデータ（タグ、注釈、評価、URLなど）の更新。
    *   アイテムのゴミ箱への移動（削除）。
    *   アイテムのサムネイル取得。

*   **できないこと (現行プロジェクトで実装済みの範囲外)**:
    *   アイテムの物理的なファイルパスの直接変更。
    *   アイテムの複製。

#### D. Library (ライブラリ)

現在開いているライブラリの情報を取得したり、ライブラリを切り替えたりします。

*   **できること**:
    *   現在開いているライブラリのパスや情報の取得。
    *   ライブラリの切り替え。
    *   ライブラリの履歴（最近使ったライブラリ）の取得。

## 3. 結論と次のステップ

Eagle APIは、Eagleライブラリ内のほとんどのデータに対するCRUD（作成、読み取り、更新、削除）操作をサポートしており、非常に強力です。特に、アイテムやフォルダの管理機能が充実しています。

一方で、APIドキュメントに明記されていない、あるいは直接的にはサポートされていない操作もいくつか存在します（例：フォルダの完全な削除）。

**次のステップとして推奨されること:**

1.  **未実装APIの追加**: 現在の `eagle-mcp-server` プロジェクトに、まだ実装されていないAPI（例：ライブラリの切り替え、アイテムのブックマーク追加など）を実装し、機能を拡充する。
2.  **エラーハンドリングの強化**: APIドキュメントで言及されているエラーケースに基づき、サーバーのエラーハンドリングをより堅牢にする。
3.  **ドキュメントの拡充**: `README.md` や `docs/` ディレクトリに、今回調査したAPI仕様の詳細を追記し、プロジェクトの利用者が参照できるようにする。
